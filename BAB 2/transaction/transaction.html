<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Transaksi</title>
  <link rel="stylesheet" href="../css/style.css">
</head>
<body>
  <header style="background:#0cac37;color:#1f2937;padding:14px 20px;">
    <div style="font-weight:700;">Transaksi Panen</div>
    <nav><a href="../admin.html" style="color:#1f2937;text-decoration:none;font-weight:600;">Kembali</a></nav>
  </header>

  <main style="max-width:700px;margin:40px auto;padding:16px;">
    <div style="background:#fff;padding:24px;border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,.08);margin-bottom:24px;">
      <form id="transForm">
        <label style="display:block;margin-bottom:8px;font-weight:600;color:#1f2937;">Judul Transaksi</label>
        <input type="text" id="judul" placeholder="Contoh: Panen Padi"
               style="width:100%;padding:12px;border:1px solid #d1d5db;border-radius:8px;margin-bottom:12px;">

        <label style="display:block;margin-bottom:8px;font-weight:600;color:#1f2937;">Jumlah (Rp)</label>
        <input type="number" id="jumlah" placeholder="500000"
               style="width:100%;padding:12px;border:1px solid #d1d5db;border-radius:8px;margin-bottom:16px;">

        <button type="submit"
                style="background:#2f855a;color:#fff;padding:10px 16px;border:none;border-radius:8px;cursor:pointer;font-weight:600;">
          Simpan
        </button>
      </form>
    </div>

    <table style="width:100%;background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 4px 12px rgba(0,0,0,.08);">
      <thead style="background:#2f855a;color:#fff;">
        <tr><th style="padding:14px;text-align:left;">#</th><th>Judul</th><th>Jumlah</th><th>Aksi</th></tr>
      </thead>
      <tbody id="transBody"></tbody>
    </table>
  </main>

  <script>
    const form = document.getElementById('transForm');
    const tbody = document.getElementById('transBody');

    // LOAD DATA DARI LOCALSTORAGE
    function load() {
      const data = JSON.parse(localStorage.getItem('transactions') || '[]');
      tbody.innerHTML = data.map((t, i) => `
        <tr style="border-bottom:1px solid #eee;">
          <td style="padding:12px;">${i+1}</td>
          <td>${t.judul || '-'}</td>
          <td>Rp ${parseInt(t.jumlah || 0).toLocaleString('id-ID')}</td>
          <td><button onclick="del(${i})" style="background:#ef4444;color:#fff;border:none;padding:6px 10px;border-radius:6px;cursor:pointer;font-size:.8rem;">Hapus</button></td>
        </tr>
      `).join('') || '<tr><td colspan="4" style="text-align:center;padding:20px;color:#9ca3af;">Belum ada transaksi</td></tr>';
    }

    // SIMPAN DATA (BISA KOSONG JUGA!)
    form.onsubmit = e => {
      e.preventDefault();

      const judul = document.getElementById('judul').value.trim();
      const jumlah = document.getElementById('jumlah').value.trim();

      // VALIDASI RINGAN (tidak paksa)
      if (!judul && !jumlah) {
        if (!confirm('Form kosong. Tetap simpan?')) return;
      }

      // Simpan ke localStorage
      const data = JSON.parse(localStorage.getItem('transactions') || '[]');
      data.push({ 
        judul: judul || 'Tanpa Judul', 
        jumlah: jumlah || '0' 
      });
      localStorage.setItem('transactions', JSON.stringify(data));

      // Reset form
      form.reset();

      // Refresh tabel
      load();

      // Notifikasi
      alert('Transaksi berhasil disimpan!');
    };

    // HAPUS DATA
    function del(i) {
      if (confirm('Hapus transaksi ini?')) {
        const data = JSON.parse(localStorage.getItem('transactions') || '[]');
        data.splice(i, 1);
        localStorage.setItem('transactions', JSON.stringify(data));
        load();
      }
    }

    // JALANKAN SAAT HALAMAN DIBUKA
    window.onload = load;
  </script>
</body>
</html>